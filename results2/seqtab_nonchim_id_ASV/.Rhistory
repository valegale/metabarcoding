plotCounts(dds_woc, gene=1570, intgroup = "type")
plotCounts(dds_cor, gene=1570, intgroup = "type")
plotCounts(dds_cor, gene=8756, intgroup = "type")
plotCounts(dds_woc, gene=8756, intgroup = "type")
plotCounts(dds_cor, gene=8756, intgroup = "type")
library(ggplot2)
df <- data.frame(dose=c("D0.5", "D1", "D2"),
len=c(4.2, 10, 29.5))
ggplot(data=df, aes(x=dose, y=len, group=1)) +
geom_line()+
geom_point()
df <- data.frame(dose=c(22.30, 23, 24),
len=c(4.2, 10, 29.5))
ggplot(data=df, aes(x=dose, y=len, group=1)) +
geom_line()+
geom_point()
ggplot(data=df, aes(x=dose, y=len, group=1)) +
geom_line()+
geom_point() +  xlab("1", "2", "3")
N
df <- data.frame(dose=c(1, 1.5, 3),
len=c(4.2, 10, 29.5))
time <- c("22.30", "23", "00")
ggplot(data=df, aes(x=dose, y=len, group=1)) +
geom_line()+
geom_point() +  scale_x_discrete(labels= time)
knitr::opts_chunk$set(echo = TRUE)
STEPA_pF <- read.csv(file="Merged_phyloFlash2.csv", header=TRUE, row.names = 1)
View(STEPA_pF)
STEPA_pF_2 <- tidyr::separate(STEPA_pF, taxa, into = paste0("TAXLEVEL", 1:20), sep = ';')
View(STEPA_pF_2)
library(dada2); packageVersion("dada2")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("dada2", version = "3.11")
R.version
install.packages(c("dplyr", "tidyr"))
readRDS(seqtab.nochim, "seqtab.nochim.RDS")
readRDS("seqtab.nochim.RDS", seqtab.nochim)
library(dada2); packageVersion("dada2")
readRDS("C:/Users/valen/OneDrive/Desktop/Umweltmetagenomics/seqtab.nochim.RDS", seqtab.nochim)
r.version
R.version
library(dada2); packageVersion("dada2")
path <- "C:/Users/valen/OneDrive/Desktop/Umweltmetagenomics/Seq_Read_files"
fnFs <- sort(list.files(path, pattern="_R1_001.fastq", full.names = TRUE))
fnRs <- sort(list.files(path, pattern="_R2_001.fastq", full.names = TRUE))
sample.names <- sapply(strsplit(basename(fnFs), "_"), `[`, 1)
sample.names
plotQualityProfile(fnFs[1:12])
fnFs
path <- "C:/Users/valen/OneDrive/Desktop/Umweltmetagenomics/"
file_name <- "seqtab_nonchim_id.csv"
path <- "C:/Users/valen/OneDrive/Desktop/Umweltmetagenomics/"
csv_table <- read.csv(file=paste(path_result, file_name, sep = ""), header=TRUE, row.names = 1)
csv_table <- read.csv(file=paste(path, file_name, sep = ""), header=TRUE, row.names = 1)
View(csv_table)
View(csv_table)
library(dplyr)
data_taxon <- csv_table %>% group_by("Order")
View(data_taxon)
data_taxon <- csv_table %>% group_by(Order)
csv_table.names
csv_table.names()
csv_table.colnames
csv_table.colnames()
colnames(csv_table)
data_taxon <- csv_table %>% group_by(Order)
data_taxon <- csv_table %>% group_by(Order) %>%
summarise(across(where(is.numeric), sum))
View(data_taxon)
data_taxon[1,]
data_taxon[,1]
data_taxon[1,]
ecco <- data_taxon[1,]
View(ecco)
ecco
sum(ecco)
ecco <- data_taxon[1,1]
ecco <- data_taxon[,c(1)]
View(ecco)
ecco <- data_taxon[,c(-1)]
View(data_taxon)
View(ecco)
ecco <- ecco[,c(-1)]
ecco <- ecco[,c(-1)]
ecco <- data_taxon[1,]
ecco <- ecco[,c(-1)]
View(ecco)
sum(ecco)
View(data_taxon)
data_order <- csv_table %>% group_by(Order) %>%
summarise(across(where(is.numeric), sum))
View(data_order)
View(data_order)
View(data_order)
colnames <- data_order$order
colnames <- data_order$Order
data_order[1:]
df_order <- t(data_order[c(-1),])
View(df_order)
df_order <- t(data_order[,c(-1)])
View(df_order)
df_order <- data_order[,c(-1)]
View(df_order)
data_order <- csv_table %>% group_by(Order) %>%
summarise(across(where(is.numeric), sum))
colnames <- data_order$Order
df_order <- data_order[,c(-1)]
df_order <- t(data_order[,c(-1)])
View(df_order)
View(df_order)
colnames(df_order) <- colnames
View(df_order)
View(data_taxon)
order <- c(1:177)
df1 <- melt(data_order,"Order")
library(reshape2)
df1 <- melt(data_order,"Order")
View(df1)
data_order_order <- data.frame(data_order, "ordering" = order)
View(data_order)
View(df1)
View(df_order)
View(df_order)
View(data_taxon)
library(reshape2)
library(ggplot2)
library(gridExtra)
#insert here the path to the Da
path = "C:/Users/valen/OneDrive/Desktop/begendiv/"
path_result = paste(path, "results500/", sep = "")
setwd(path_result)
setwd(path_result)
file_list <- list.files()
ggplot_list <- list()
i = 1
for (file_name in file_list){
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=FALSE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
df1 <- data.frame(file_csv[,1:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
ggplot_list[[i]] = g
i <- i +1
#for points <- geom_point(aes(color=row_names))
}
length(ggplot_list)
dir.create("../plots_ciao")
path_plots = paste(path, "/plots_ciao", sep = "")
setwd(path_plots)
i <- 0
nCol <- floor(sqrt(8))
while ((i*8 + 1) < length(ggplot_list)){
if (length(ggplot_list) < ((i+1)*8)){
stripped_ggplot <- ggplot_list[(i*8 + 1):length(ggplot_list)]
}
else{
stripped_ggplot <- ggplot_list[(i*8 + 1):((i+1)*8)]
}
image_to_save <- do.call("arrangeGrob", c(stripped_ggplot, ncol=nCol))
i <- i + 1
name_file <- paste("image", i, sep = "")
name_file <- paste(name_file, ".png")
ggsave(file=name_file, image_to_save)
}
file_name = "Aulacoseira_granulata.csv"
file_csv <- read.csv(file=paste(path, file_name, sep = ""), header=FALSE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
df1 <- data.frame(file_csv[,1:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
g
length(ggplot_list)
path = "C:/mnt/c/metabarcoding"
path = "C:/mnt/c/metabarcoding/results"
#insert name of the directory with all results
path_result = paste(path, "seqtab_nonchim_id_ASV/", sep = "")
setwd(path_result)
path = "C:/mnt/c/metabarcoding/results/"
#insert name of the directory with all results
path_result = paste(path, "seqtab_nonchim_id_ASV/", sep = "")
setwd(path_result)
path = "C:mnt/c/metabarcoding/results/"
#insert name of the directory with all results
path_result = paste(path, "seqtab_nonchim_id_ASV/", sep = "")
setwd(path_result)
dir
ls
cd ..
path = "C:/metabarcoding/results/"
#insert name of the directory with all results
path_result = paste(path, "seqtab_nonchim_id_ASV/", sep = "")
setwd(path_result)
file_list <- list.files()
ggplot_list <- list()
i = 1
for (file_name in file_list){
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=FALSE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
df1 <- data.frame(file_csv[,1:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
ggplot_list[[i]] = g
i <- i +1
#for points <- geom_point(aes(color=row_names))
}
length(ggplot_list)
ir.create("../plots"
zza
dir.create("../plots")
path = "C:/metabarcoding/results/"
path_result = paste(path, "seqtab_nonchim_id_ASV", sep = "")
setwd(path_result)
file_list <- list.files()
ggplot_list <- list()
i = 1
for (file_name in file_list){
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=FALSE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
df1 <- data.frame(file_csv[,1:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
ggplot_list[[i]] = g
i <- i +1
#for points <- geom_point(aes(color=row_names))
}
path_result = paste(path, "seqtab_nonchim_id_ASV/", sep = "")
setwd(path_result)
file_list <- list.files()
ggplot_list <- list()
i = 1
for (file_name in file_list){
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=FALSE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
df1 <- data.frame(file_csv[,1:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
ggplot_list[[i]] = g
i <- i +1
#for points <- geom_point(aes(color=row_names))
}
length(ggplot_list)
path <- "C:/metabarcoding/results/"
#insert name of the directory with all results
results_dir <- "seqtab_nonchim_id_ASV/"
path_result <- paste(path, results_dir, sep = "")
setwd(path_result)
path_result
path_plots <- paste(path, "/plots/", results_dir)
path_plots
path_plots <- paste(path, "/plots/", results_dir, sep = "")
path_plots
path_plots <- paste(path, "plots/", results_dir, sep = "")
path_plots
dir.create(path_plots)
setwd(path_plots)
i <- 0
nCol <- floor(sqrt(8))
while ((i*8 + 1) < length(ggplot_list)){
if (length(ggplot_list) < ((i+1)*8)){
stripped_ggplot <- ggplot_list[(i*8 + 1):length(ggplot_list)]
}
else{
stripped_ggplot <- ggplot_list[(i*8 + 1):((i+1)*8)]
}
image_to_save <- do.call("arrangeGrob", c(stripped_ggplot, ncol=nCol))
i <- i + 1
name_file <- paste("image", i, sep = "")
name_file <- paste(name_file, ".png")
ggsave(file=name_file, image_to_save)
}
path_plots = paste(path, "/plots", sep = "")
path_result <- paste(path, results_dir, sep = "")
path_plots <- paste(path, "plots/", results_dir, sep = "")
dir.create(path_plots)
setwd(path_plots)
i <- 0
nCol <- floor(sqrt(2))
while ((i*2 + 1) < length(ggplot_list)){
if (length(ggplot_list) < ((i+1)*2)){
stripped_ggplot <- ggplot_list[(i*2 + 1):length(ggplot_list)]
}
else{
stripped_ggplot <- ggplot_list[(i*2 + 1):((i+1)*2)]
}
image_to_save <- do.call("arrangeGrob", c(stripped_ggplot, ncol=nCol))
i <- i + 1
name_file <- paste("image", i, sep = "")
name_file <- paste(name_file, ".png")
ggsave(file=name_file, image_to_save)
}
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=FALSE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
df1 <- data.frame(file_csv[,1:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g
View(df1)
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=TRUE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
df1 <- data.frame(file_csv[,1:n_col],
"row_names" = r_n)
View(df1)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
g
View(df1)
View(df2)
r_n
df1 <- data.frame(file_csv[,2:n_col],
"row_names" = r_n)
View(df1)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
g
r_n <- file_csv[,1]
r_n
df1 <- data.frame(file_csv[,2:n_col],
"row_names" = r_n)
View(df1)
r_n
df1 <- data.frame(file_csv[,2:n_col],
"row_names" = r_n)
View(df1)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
g
file_list <- list.files()
ggplot_list <- list()
i = 1
for (file_name in file_list){
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=TRUE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
r_n <- file_csv[,1]
df1 <- data.frame(file_csv[,2:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
ggplot_list[[i]] = g
i <- i +1
#for points <- geom_point(aes(color=row_names))
}
file_list <- list.files()
ggplot_list <- list()
i = 1
for (file_name in file_list){
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=TRUE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
r_n <- file_csv[,1]
df1 <- data.frame(file_csv[,2:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
ggplot_list[[i]] = g
i <- i +1
#for points <- geom_point(aes(color=row_names))
}
length(ggplot_list)
path_plots <- paste(path, "plots/", results_dir, sep = "")
path <- "C:/metabarcoding/results/"
#insert name of the directory with all results
results_dir <- "seqtab_nonchim_id_ASV/"
path_result <- paste(path, results_dir, sep = "")
setwd(path_result)
path_result
file_list <- list.files()
ggplot_list <- list()
i = 1
for (file_name in file_list){
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=TRUE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
r_n <- file_csv[,1]
df1 <- data.frame(file_csv[,2:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
ggplot_list[[i]] = g
i <- i +1
#for points <- geom_point(aes(color=row_names))
}
length(ggplot_list)
path_plots <- paste(path, "plots/", results_dir, sep = "")
dir.create(path_plots)
setwd(path_plots)
i <- 0
nCol <- floor(sqrt(2))
while ((i*2 + 1) < length(ggplot_list)){
if (length(ggplot_list) < ((i+1)*2)){
stripped_ggplot <- ggplot_list[(i*2 + 1):length(ggplot_list)]
}
else{
stripped_ggplot <- ggplot_list[(i*2 + 1):((i+1)*2)]
}
image_to_save <- do.call("arrangeGrob", c(stripped_ggplot, ncol=nCol))
i <- i + 1
name_file <- paste("image", i, sep = "")
name_file <- paste(name_file, ".png")
ggsave(file=name_file, image_to_save)
}
g
tools::file_path_sans_ext(file_name)
name_file <- paste(path_plots, tools::file_path_sans_ext(file_name), ".png", sep = "")
name_file
file_list <- list.files()
ggplot_list <- list()
setwd(path_result)
path_plots <- paste(path, "plots/", results_dir, sep = "")
dir.create(path_plots)
file_list <- list.files()
ggplot_list <- list()
i = 1
for (file_name in file_list){
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=TRUE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
r_n <- file_csv[,1]
df1 <- data.frame(file_csv[,2:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
ggplot_list[[i]] = g
i <- i +1
name_file <- paste(path_plots, tools::file_path_sans_ext(file_name), ".png", sep = "")
ggsave(name_file, width = 8, height = 4.5, dpi=500)
#for points <- geom_point(aes(color=row_names))
}
#insert here the file with the species you are interested in, example:
# file_name = "Aulacoseira_granulata.csv"
file_name = "Aulacoseira_granulata.csv"
#insert here the file with the species you are interested in, example:
# file_name = "Aulacoseira_granulata.csv"
file_name = "Aulacoseira_granulata.csv"
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=TRUE, row.names = 1)
View(file_csv)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
r_n <- file_csv[,1]
df1 <- data.frame(file_csv[,2:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("time")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
g
g + geom_point(aes(color=row_names))
#insert here the file with the species you are interested in, example:
# file_name = "Aulacoseira_granulata.csv"
file_name = "Aulacoseira_granulata.csv"
file_csv <- read.csv(file=paste(path_result, file_name, sep = ""), header=TRUE, row.names = 1)
n_col = ncol(file_csv)-9
n_row = nrow(file_csv)
r_n <- paste( "species", 1:n_row)
r_n <- file_csv[,1]
df1 <- data.frame(file_csv[,2:n_col],
"row_names" = r_n)
df2 <- melt(df1,"row_names")
g <- ggplot(data=df2, aes(x=variable, y=value, group=row_names)) +
geom_line(aes(color=row_names))+ ylab("# reads") +
xlab("samples")+ theme(legend.title = element_blank(), axis.text.x = element_blank()) + ggtitle(tools::file_path_sans_ext(file_name))
g + geom_point(aes(color=row_names))
